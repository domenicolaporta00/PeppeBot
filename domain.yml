version: "3.1"

intents:
  - greet
  - goodbye
  - help
  - ask_identity
  - ask_greenmarket_story
  - ask_top_rated
  - nlu_fallback
  - search_by_name
  - select_recipe
  - search_by_category
  - ask_nutrition
  - ask_cooking_time
  - search_by_ingredient
  - trigger_svuota_frigo
  - inform_time
  - trigger_nutrition_search
  - trigger_full_meal
  - random_recipe
  - stop

entities:
  - recipe_name
  - recipe_id
  - category
  - nutrient
  - ingredient
  - time_limit

slots:
  recipe_name:
    type: text
    influence_conversation: false
    mappings:
      - type: from_entity
        entity: recipe_name

  recipe_id:
    type: text
    influence_conversation: false
    mappings:
      - type: from_entity
        entity: recipe_id

  nutrient:
    type: text
    influence_conversation: false
    mappings:
      - type: from_entity
        entity: nutrient

  ingredient:
    type: list
    influence_conversation: false
    mappings:
      - type: from_entity
        entity: ingredient
      - type: from_text
        not_intent:
          - stop
        conditions:
          - active_loop: svuota_frigo_form
            requested_slot: ingredient

  category:
    type: list
    influence_conversation: false
    mappings:
      - type: from_entity
        entity: category
      - type: from_text
        not_intent:
          - stop
        conditions:
          - active_loop: svuota_frigo_form
            requested_slot: category

  time_limit:
    type: text
    influence_conversation: false
    mappings:
      - type: from_entity
        entity: time_limit
      - type: from_text
        not_intent:
          - stop
        conditions:
          - active_loop: svuota_frigo_form
            requested_slot: time_limit

  max_calories:
    type: text
    influence_conversation: false
    mappings:
      - type: from_text
        not_intent:
          - stop
        conditions:
          - active_loop: nutrition_search_form
            requested_slot: max_calories

  max_carbs:
    type: text
    influence_conversation: false
    mappings:
      - type: from_text
        not_intent:
          - stop
        conditions:
          - active_loop: nutrition_search_form
            requested_slot: max_carbs

  max_fat:
    type: text
    influence_conversation: false
    mappings:
      - type: from_text
        not_intent:
          - stop
        conditions:
          - active_loop: nutrition_search_form
            requested_slot: max_fat

  max_protein:
    type: text
    influence_conversation: false
    mappings:
      - type: from_text
        not_intent:
          - stop
        conditions:
          - active_loop: nutrition_search_form
            requested_slot: max_protein

  meal_tag:
    type: text
    influence_conversation: false
    mappings:
      - type: from_text
        not_intent:
          - stop
        conditions:
          - active_loop: full_meal_form
            requested_slot: meal_tag

actions:
  - action_show_top_rated
  - action_search_by_name
  - action_select_recipe_by_id
  - action_search_by_category
  - action_ask_nutrition
  - action_ask_cooking_time
  - action_search_by_ingredient
  - validate_svuota_frigo_form
  - action_submit_svuota_frigo
  - validate_nutrition_search_form
  - action_submit_nutrition_search
  - validate_full_meal_form
  - action_submit_full_meal
  - action_random_recipe
  - action_reset_svuota_frigo_form
  - action_reset_nutrition_search_form
  - action_reset_full_meal_form

forms:
  svuota_frigo_form:
    required_slots:
      - ingredient
      - time_limit
      - category

  nutrition_search_form:
    required_slots:
      - max_calories
      - max_carbs
      - max_fat
      - max_protein

  full_meal_form:
    required_slots:
      - meal_tag

responses:
  utter_greet:
  - text: "Hello! ğŸ‘¨â€ğŸ³ I am PeppeBot from GreenMarket. How can I help you today?"
  - text: "Hi! Welcome to GreenMarket. Are you ready to cook something good?"
  - text: "Hello! PeppeBot here. Tell me what ingredients you have!"

  utter_goodbye:
  - text: "Bye! ğŸ‘‹ Have fun cooking your recipe!"
  - text: "Goodbye! I hope your meal tastes delicious! ğŸ¥˜"
  - text: "See you soon! Come back when your fridge is empty!"
  - text: "Bye! Enjoy your meal! ğŸ˜‹"

  utter_help:
  - text: |
      I am PeppeBot ğŸ‘¨â€ğŸ³, your cooking assistant. Here is exactly what I can do:

      1. *Empty Fridge Search* ğŸ§Š
         I find the ideal recipe based on your ingredients, time, and diet.
         _Try saying:_ "I have chicken and tomatoes" or "Empty fridge"

      2. *Fitness Search* ğŸ¥—
         I filter recipes by health parameters like calories, proteins, or sugar.
         _Try saying:_ "Recipes under 500 calories" or "High protein dish"

      3. *Search by Name* ğŸ”
         I find a specific dish by its name.
         _Try saying:_ "Search for Carbonara"

      4. *Search by Category* ğŸ°
         I suggest recipes for a specific category (e.g., dessert, vegan).
         _Try saying:_ "I want a dessert" or "Show me vegan recipes"

      5. *Top Rated Recipes* â­
         I show recipes with the highest user ratings.
         _Try saying:_ "Show me the best recipes"

      6. *Recipe Details* ğŸ“
         Ask me about *Steps*, *Nutrition*, or *Cooking Time* for a dish.
         _Try saying:_ "How do I cook this?", "Show me calories", or "How long does it take?"

  utter_identity:
  - text: |
      I am a bot ğŸ¤–, not a human!
      
      I was developed in *February 2026* by *Domenico, Lorenzo, and Yassir*.
      
      They named me *PeppeBot* in honor of Grandfather Peppe, the original founder of GreenMarket! ğŸ…

  utter_greenmarket_story:
  - text: |
      Here is our story! ğŸ“–

      GreenMarket started in *1965 in Ancona*. It was founded by *Giuseppe 'Peppe' Izzi*, a farmer from Montenero di Bisaccia who moved to the city. He loved fresh and sustainable food! ğŸ…

      Today, the shop is managed by his grandson *Giuseppe* and his business partner *Domenico La Porta*.

      They created this App to bring quality products directly to your home, offering exclusive discounts and custom shopping lists. ğŸ›’

  utter_ask_ingredient:
    - text: "ğŸ¥¦ Let's empty that fridge! First, what ingredients do you want to use? (e.g., chicken, onion, eggs)"
  
  utter_ask_time_limit:
    - text: "â±ï¸ Got it. How many minutes do you have to cook? (e.g., 30)"
  
  utter_ask_category:
    - text: "ğŸ·ï¸ Finally, do you want a specific category or diet? (e.g., Vegan, Spicy, Dinner. If none, just type 'none')"
  
  utter_ask_max_calories:
    - text: "ğŸ¥— Let's find your perfect meal! ABOUT HOW MANY CALORIES are you aiming for? (e.g., 500)"
  
  utter_ask_max_carbs:
    - text: "ğŸ Got it. What is your TARGET for CARBOHYDRATES? (Enter a % PDV, e.g., 30)"
  
  utter_ask_max_fat:
    - text: "ğŸ¥“ And what is your TARGET for TOTAL FAT? (Enter a % PDV)"
  
  utter_ask_max_protein:
    - text: "ğŸ¥© Lastly, what is your TARGET for PROTEIN? (Enter a % PDV)"

  utter_ask_meal_tag:
    - text: "ğŸ½ï¸ Awesome! Let's plan a Full Course Meal. What THEME or TAG do you want for the menu?"
      buttons:
        - title: "ğŸ• Italian"
          payload: "italian"
        - title: "ğŸŒ® Mexican"
          payload: "mexican"
        - title: "ğŸ¥¢ Asian"
          payload: "asian"
        - title: "ğŸ› Indian"
          payload: "indian"
        - title: "ğŸ¥‘ Vegan"
          payload: "vegan"
        - title: "ğŸ¥— Healthy"
          payload: "healthy"
        - title: "ğŸ§€ Comfort Food"
          payload: "comfort-food"
        - title: "ğŸ•¯ï¸ Romantic"
          payload: "romantic"
        - title: "â˜€ï¸ Summer"
          payload: "summer"
        - title: "â„ï¸ Winter"
          payload: "winter"

  utter_form_stopped:
    - text: "ğŸ›‘ No problem, chef! I've cancelled the current request. What would you like to do next?"
  
  utter_fallback:
  - text: |
      I'm sorry, I didn't understand that. ğŸ˜•
      Could you please rephrase?
      
      If you are stuck, type **"help"** to see what I can do!

session_config:
  session_expiration_time: 60
  carry_over_slots_to_new_session: true
